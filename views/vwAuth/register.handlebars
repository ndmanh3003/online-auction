{{#section 'css'}}
<script src="https://www.google.com/recaptcha/api.js" async defer></script>
{{/section}}
<div
  class="max-w-2xl mx-auto my-20 p-8 bg-white rounded-3xl shadow-[0_4px_20px_rgba(0,0,0,0.08)] border border-gray-200/60"
>
  <h2 class="text-[28px] font-semibold text-gray-900 text-center mb-8">
    Registration
  </h2>
  <form method="post" id="frmRegister" class="space-y-6">
    <div class="relative mb-6">
      <input
        type="text"
        id="name"
        name="name"
        class="w-full px-4 py-4 border border-gray-200/60 rounded-2xl focus:ring-2 focus:ring-black/10 focus:outline-none transition-all duration-300 text-gray-900"
        placeholder="Full Name"
        required
      />
    </div>
    <div class="relative mb-6">
      <input
        type="email"
        id="email"
        name="email"
        class="w-full px-4 py-4 border border-gray-200/60 rounded-2xl focus:ring-2 focus:ring-black/10 focus:outline-none transition-all duration-300 text-gray-900"
        placeholder="Email"
        required
      />
    </div>
    <div class="relative mb-6">
      <input
        type="password"
        id="password"
        name="password"
        class="w-full px-4 py-4 border border-gray-200/60 rounded-2xl focus:ring-2 focus:ring-black/10 focus:outline-none transition-all duration-300 text-gray-900"
        placeholder="Password"
        required
      />
    </div>
    <div class="relative mb-6">
      <input
        type="password"
        id="confirmPassword"
        name="confirmPassword"
        class="w-full px-4 py-4 border border-gray-200/60 rounded-2xl focus:ring-2 focus:ring-black/10 focus:outline-none transition-all duration-300 text-gray-900"
        placeholder="Confirm Password"
        required
      />
    </div>
    <div class="relative mb-6">
      <input
        type="date"
        id="dob"
        name="dob"
        class="w-full px-4 py-4 border border-gray-200/60 rounded-2xl focus:ring-2 focus:ring-black/10 focus:outline-none transition-all duration-300 text-gray-900"
      />
    </div>
    <div class="relative mb-6">
      <input
        type="text"
        id="address"
        name="address"
        class="w-full px-4 py-4 border border-gray-200/60 rounded-2xl focus:ring-2 focus:ring-black/10 focus:outline-none transition-all duration-300 text-gray-900"
        placeholder="Address (optional)"
      />
    </div>
    <div class="g-recaptcha mb-6" data-sitekey="{{recaptchaSiteKey}}"></div>
    <button
      type="submit"
      class="w-full px-6 py-4 bg-blue-600 text-white rounded-xl shadow-[0_4px_20px_rgba(37,99,235,0.3)] hover:bg-blue-700 hover:scale-105 hover:shadow-lg transition-all duration-300 ease-out font-medium"
    >
      Register
    </button>
  </form>
  <div class="text-center mt-6">
    <span class="text-sm text-gray-600">Already have an account? </span>
    <a
      href="/auth/login"
      class="text-sm text-gray-900 font-medium hover:underline"
      >Sign in</a
    >
  </div>
</div>
{{#> modal id="otpModal" title="Email Verification"}}
<form
  method="post"
  action="/auth/verify-email"
  id="frmVerifyOTP"
  class="space-y-6"
>
  <p class="text-gray-600 text-center mb-6">
    Please enter the OTP code sent to your email.
  </p>
  <div class="relative mb-6">
    <input
      type="text"
      id="otpCode"
      name="code"
      maxlength="6"
      class="w-full px-4 py-4 border border-gray-200/60 rounded-2xl focus:ring-2 focus:ring-black/10 focus:outline-none transition-all duration-300 text-gray-900 text-center text-2xl tracking-widest"
      placeholder="000000"
      required
      autofocus
    />
  </div>
  <button
    type="submit"
    class="w-full px-6 py-4 bg-blue-600 text-white rounded-xl shadow-[0_4px_20px_rgba(37,99,235,0.3)] hover:bg-blue-700 hover:scale-105 hover:shadow-lg transition-all duration-300 ease-out font-medium"
  >
    Verify
  </button>
</form>
{{/modal}} {{#section 'js'}}
<script>
  document
    .getElementById('frmRegister')
    .addEventListener('submit', function (e) {
      const password = document.getElementById('password').value
      const confirmPassword = document.getElementById('confirmPassword').value
      if (password !== confirmPassword) {
        e.preventDefault()
        window.errorMessage = 'Password confirmation does not match.'
        window.location.reload()
        return false
      }
      e.preventDefault()
      const form = this
      const formData = new FormData(form)
      fetch(form.action, {
        method: 'POST',
        body: formData,
      })
        .then(function (response) {
          if (response.ok || response.redirected) {
            const otpModal = document.getElementById('otpModal')
            if (otpModal) {
              otpModal.classList.remove('hidden')
              const otpCodeInput = document.getElementById('otpCode')
              if (otpCodeInput) {
                otpCodeInput.focus()
                otpCodeInput.addEventListener('input', function (e) {
                  this.value = this.value.replace(/[^0-9]/g, '')
                })
              }
            }
          } else {
            alert('An error occurred. Please try again.')
          }
        })
        .catch(function (error) {
          console.error('Error:', error)
          alert('An error occurred. Please try again.')
        })
      return false
    })
</script>
{{/section}}
